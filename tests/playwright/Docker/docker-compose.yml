version: '3'

services:
  xdmod:
    image: tools-ext-01.ccr.xdmod.org/xdmod-job_performance-10.0.0:rockylinux8-0.1
    hostname: xdmod
    container_name: xdmod
    volumes:
      - /Users/ryanrath/scratch/cache/rocky8/xdmod/dnf.conf:/etc/dnf/dnf.conf
      - /Users/ryanrath/scratch/cache/rocky8/xdmod/dnf:/var/cache/dnf
    networks:
      - testing
    shm_size: 2g
    ports:
      - '8080:443'
      - '7000:7000'
    environment:
      XDMOD_REALMS: 'jobs,storage,cloud,supremm,jobefficiency'
    command: sleep infinity
  playwright:
    image: mcr.microsoft.com/playwright:v1.39.0-focal
    hostname: playwright
    container_name: playwright
    networks:
      - testing
    links:
      - xdmod
    depends_on:
      - xdmod
    environment:
      BASE_URL: 'https://xdmod'
      XDMOD_REALMS: 'jobs,storage,cloud,supremm,jobefficiency'
    command: sleep infinity

networks:
  testing:
